# 产品需求文档 (PRD) - Windows 水印文件本地应用

## 1. 项目概述

### 1.1 项目目标
开发一款本地运行在 Windows 操作系统上的桌面应用程序，旨在为用户提供一个简单、高效的工具，用于为单张或多张图片添加自定义文本或图片水印。

### 1.2 目标用户
- **摄影师**：保护作品版权，防止未经授权的使用。
- **内容创作者/自媒体**：在社交媒体发布的图片上添加个人或品牌标识。
- **设计师**：向客户交付样本稿时添加水印。
- **普通用户**：为个人图片添加趣味性或纪念性文字。

## 2. 功能需求

### 2.1 文件处理

#### 2.1.1 图片导入
- **[P0]** 支持通过拖拽方式导入单张图片。
- **[P0]** 支持通过系统文件选择器导入单张或多张图片。
- **[P0]** 支持导入整个文件夹，应用将自动筛选出其中支持的图片格式。
- **[P0]** 主界面需要有一个列表区域，用于显示已导入图片的缩略图和文件名。

#### 2.1.2 支持格式
- **[P0]** **输入格式**: 必须支持 JPEG, PNG。PNG 格式必须支持并保持透明通道。
- **[P1]** **输入格式 (建议)**: 强烈建议支持 BMP, TIFF 格式。
- **[P0]** **输出格式**: 用户可以选择将添加水印后的图片保存为 JPEG 或 PNG 格式。

#### 2.1.3 图片导出
- **[P0]** 用户必须能指定一个用于保存输出图片的文件夹。
- **[P0]** 为防止意外覆盖原始文件，默认禁止将图片导出到原始文件夹。
- **[P0]** 提供灵活的文件命名规则选项：
    - 保留原文件名。
    - 在原文件名前添加自定义前缀 (例如 `wm_`)。
    - 在原文件名后添加自定义后缀 (例如 `_watermarked`)。
- **[P1]** **(高级功能)** 对于 JPEG 输出格式，提供一个从 0 到 100 的滑块，用于调节图片质量（压缩率）。
- **[P2]** **(高级功能)** 导出时，允许用户选择是否调整图片尺寸（例如，按宽度、高度或百分比进行缩放）。

### 2.2 水印类型

#### 2.2.1 文本水印
- **[P0]** 用户可以输入任意自定义文本作为水印内容。
- **[P0]** 用户可以调节文本的透明度（0-100%）。
- **[P1]** **(高级功能)** 用户可以选择系统已安装的字体、调整字号、设置粗体或斜体。
- **[P1]** **(高级功能)** 提供调色板让用户选择字体颜色。
- **[P2]** **(高级功能)** 可为文本添加阴影或描边效果，以增强在复杂背景下的可读性。

#### 2.2.2 图片水印
- **[P1]** **(高级功能)** 用户可以从本地选择一张图片（如 Logo）作为水印。
- **[P1]** **(高级功能)** 必须支持带透明通道的 PNG 图片作为水印。
- **[P1]** **(高级功能)** 用户可以按比例或自由调整图片水印的大小。
- **[P1]** **(高级功能)** 用户可以调节图片水印的整体透明度（0-100%）。

### 2.3 水印布局与样式

#### 2.3.1 实时预览
- **[P0]** 应用主界面必须包含一个预览窗口。
- **[P0]** 所有对水印的调整（内容、位置、大小、颜色、透明度等）都应在预览窗口中实时反馈。
- **[P0]** 用户可以通过点击图片列表来切换预览不同的图片。

#### 2.3.2 位置
- **[P0]** 提供九宫格预设位置（上/中/下 + 左/中/右），用户可一键将水印放置在这些常用位置。
- **[P0]** 用户可以直接在预览图上通过鼠标拖拽来手动放置水印到任意位置。

#### 2.3.3 旋转
- **[P2]** **(高级功能)** 提供一个滑块或输入框，允许用户以任意角度旋转水印。

### 2.4 配置管理

#### 2.4.1 水印模板
- **[P1]** 用户可以将当前的所有水印设置（内容、字体、颜色、位置、大小、透明度等）保存为一个可命名的模板。
- **[P1]** 用户可以加载、管理（重命名、删除）已保存的模板。
- **[P1]** 程序启动时，可自动加载上一次关闭时的设置或一个用户指定的默认模板。

## 3. 非功能性需求

### 3.1 平台
- **[P0]** 应用程序必须是为 Windows 平台构建的本地应用。

### 3.2 性能
- **[P0]** 界面操作应流畅，无明显卡顿。
- **[P0]** 实时预览响应应足够快。
- **[P1]** 批量处理大量图片时，应有进度提示（如进度条），且不能冻结主界面。

### 3.3 用户体验
- **[P0]** 界面设计应简洁、直观，易于上手。
- **[P0]** 关键操作应有明确的提示或反馈。

## 4. 技术栈提议

- **核心框架**: **Electron.js** - 使用 HTML, CSS, JavaScript 构建跨平台桌面应用，社区成熟，生态丰富。
- **前端**: HTML, CSS, JavaScript (使用 Vue.js简化 UI 开发)。
- **后端 (Node.js)**:
    - **图像处理**: `sharp` 库，性能高，功能强大，支持多种图像操作。
    - **文件系统**: Node.js 内置的 `fs` 模块。
- **打包与分发**: `electron-builder`，可将应用打包成独立的 `.exe` 安装程序或绿色版，方便在 GitHub Releases 中分发。

## 5. 里程碑

1.  **M1: 核心功能实现**
    - 完成基本UI框架。
    - 实现图片导入、列表展示和预览。
    - 实现基础文本水印（内容、位置、透明度）。
    - 实现图片导出功能（固定命名）。
2.  **M2: 高级功能完善**
    - 完善文本水印高级功能（字体、颜色等）。
    - 实现图片水印功能。
    - 完善导出选项（命名规则、JPEG质量）。
3.  **M3: 体验优化与配置**
    - 实现水印模板的保存与加载。
    - 优化UI/UX，修复Bug。
    - 构建并发布第一个 Release 版本。
